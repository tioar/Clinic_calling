<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>陳萬龍診所叫號系統</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
  body{
    font-family:'Noto Sans TC',sans-serif;
    background:#eef3f7;
    display:flex; justify-content:center;
    padding:40px 0; margin:0;
  }

  .container{
    max-width:800px; width:100%;
    background:#ffffff;
    border-radius:24px;
    padding:32px 24px;
    text-align:center;
    box-shadow:0 8px 24px rgba(0,0,0,0.12);
  }

  /* 跑馬燈 */
  .marquee{
    background:#6b7280; color:white;
    border-radius:12px;
    padding:10px 0; margin-bottom:24px;
    overflow:hidden; white-space:nowrap;
  }
  .marquee span{
    display:inline-block;
    padding-left:100%;
    animation:marquee 12s linear infinite;
  }
  @keyframes marquee{
    0%{transform:translateX(0);}
    100%{transform:translateX(-100%);}
  }

  h1{ font-weight:700; margin-bottom:24px; color:#1e3c53; }

  /* 翻頁鐘卡片 */
  .number-display{
    display:flex; justify-content:center; gap:12px;
    margin-bottom:16px;
  }
  .digit-card{
    width:90px; height:120px;
    background:#e1effa; /* 淺藍底 */
    color:#dc2626; /* 紅字 */
    font-family:'Share Tech Mono', monospace;
    font-size:90px; font-weight:bold;
    border-radius:16px;
    display:flex; align-items:center; justify-content:center;
    position:relative;
    perspective:400px;
    overflow:hidden;
  }
  .digit-card .current, .digit-card .next{
    position:absolute; width:100%; height:100%;
    left:0; top:0;
    display:flex; align-items:center; justify-content:center;
    backface-visibility:hidden;
  }
  .digit-card .next{ transform:rotateX(-180deg); }

  .flip .current{ animation:flipTop 0.5s forwards; }
  .flip .next{ animation:flipBottom 0.5s forwards; }

  @keyframes flipTop{
    0%{ transform:rotateX(0deg);}
    100%{ transform:rotateX(180deg);}
  }
  @keyframes flipBottom{
    0%{ transform:rotateX(-180deg);}
    100%{ transform:rotateX(0deg);}
  }

  .note{
    background:#f1f5f9; padding:16px 20px;
    border-radius:16px; margin:16px 0;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    font-weight:500; color:#1e3c53;
  }

  .btn{
    border-radius:50px; padding:14px 32px;
    font-weight:700; text-decoration:none;
    display:inline-block; margin:10px;
    border:none; cursor:pointer;
    background:#cbd5e1; color:#1e3c53;
    font-size:18px;
    min-width:160px;
    transition:all 0.3s;
  }
  .btn:hover{ background:#3b82f6; color:white; }

  .schedule{
    margin-top:24px; max-width:100%;
    border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.08);
  }

  .popup{
    position:fixed; top:20px; right:20px;
    background:#22c55e; color:white;
    padding:16px 28px; border-radius:50px;
    font-size:20px; z-index:9999;
    opacity:0; transform:translateY(-20px);
    animation:fadeInOut 3s forwards;
  }
  @keyframes fadeInOut{
    0%{opacity:0; transform:translateY(-20px);}
    10%{opacity:1; transform:translateY(0);}
    90%{opacity:1; transform:translateY(0);}
    100%{opacity:0; transform:translateY(-20px);}
  }
</style>
</head>
<body>
<div class="container">
  <div class="marquee"><span>預約掛號請在門診結束前一小時報到</span></div>
  <h1>陳萬龍診所門診目前號碼</h1>

  <div class="number-display" id="numberDisplay">
    <div class="digit-card"><div class="current">0</div><div class="next">0</div></div>
    <div class="digit-card"><div class="current">0</div><div class="next">0</div></div>
    <div class="digit-card"><div class="current">0</div><div class="next">0</div></div>
  </div>

  <div class="note">每位患者約三到五分鐘，請提前到場以免過號。</div>

  <div>
    <button class="btn" onclick="fetchNumber()">刷新頁面</button>
    <a href="https://你的預約網址" class="btn">預約掛號</a>
  </div>

  <img src="https://raw.githubusercontent.com/你的帳號/你的repo/main/schedule.png" alt="門診時間表" class="schedule">
</div>

<script>
let lastNumber='000';

function showPopup(msg){
  const popup=document.createElement('div');
  popup.className='popup';
  popup.innerText=msg;
  document.body.appendChild(popup);
  setTimeout(()=>popup.remove(),3000);
}

function formatNumber(num){ return String(num).padStart(3,'0'); }

function animateNumber(newNumber){
  const digits=document.querySelectorAll('#numberDisplay .digit-card');
  newNumber.split('').forEach((d,i)=>{
    const card = digits[i];
    const current = card.querySelector('.current');
    const next = card.querySelector('.next');
    if(current.innerText!==d){
      next.innerText=d;
      card.classList.add('flip');
      setTimeout(()=>{
        current.innerText=d;
        card.classList.remove('flip');
      },500);
    }
  });
}

async function fetchNumber(){
  try{
    const res=await fetch("https://script.google.com/macros/s/AKfycbxmehGXGH_bPOD9tlOTibLzRuH35Jy3hiShjPlag2rSzpm-9c9VKTduRbc4Bjf6nifd/exec");
    const data=await res.json();
    let currentNumber=formatNumber(data.number);
    if(currentNumber!==lastNumber){
      animateNumber(currentNumber);
      showPopup("請 "+currentNumber+" 號進診間");
      lastNumber=currentNumber;
    }
  }catch(e){console.error("抓號碼失敗",e);}
}

setInterval(fetchNumber,5000);
fetchNumber();
</script>
</body>
</html>
